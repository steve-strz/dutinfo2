#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <pwd.h>
#include <errno.h>
#include <assert.h>

int main(int argc, char * argv[]) { 
  int code = 0;
  char LIGNE[256];

  code = mysystem("ls"); // le vrai 
  printf("code retour : %d\n", code);

  code = mysystem("ls"); // pareil avec le notre 
  printf("code retour : %d\n", code);

  code = mysystem("who"); // on peut faire autre chose que ls 
  printf("code retour : %d\n", code);

  assert(argc > 1);
  // coller tous les arguments de la ligne de commande en un seul char * dans LIGNE ... `a compl ÃÅeter

  //code = mysystem(LIGNE); 
  printf("code retour : %d\n", code); 
  exit(EXIT_SUCCESS);
}

int mysystem(char *command){
  char *myargv[4];
  int retcode;
  pid_t pid;

  if((pid = fork()) < 0){
    perror("fork error");
    return -1;
  }
  if(pid == 0){
    myargv[0]="sh";
    myargv[1]="-c";
    myargv[2] = command;
    myargv[3] = (char *) NULL;
    execv("/bin/sh", myargv);
    exit(127);
  }
  waitpid(pid, &retcode, 0);
  return WEXITSTATUS(retcode);
}